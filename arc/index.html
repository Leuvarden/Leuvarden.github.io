<!doctype html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<title>Circles</title>
	<script type="text/javascript" src="phaser.min.js"></script>
</head>

<body>
	<div id="test"></div>

	<script type="text/javascript">
		var game = new Phaser.Game(700, 700, Phaser.AUTO, 'test', {preload: preload, create: create});

		function preload() {
			game.load.image('center', 'circle2.png');
			game.load.image('outer', 'circle1.png');
			game.load.image('middle',  'circle3.png')
		}

		function create() {
			game.stage.backgroundColor = '#ffffff';
			let outer = game.add.sprite(game.world.centerX, game.world.centerY, 'outer');
			let middle = game.add.sprite(game.world.centerX, game.world.centerY, 'middle');
			let center = game.add.sprite(game.world.centerX, game.world.centerY, 'center');

			outer.anchor.setTo(0.5, 0.5);
			center.anchor.setTo(0.5, 0.5);
			middle.anchor.setTo(0.5, 0.5);

			outer.inputEnabled = true;
			middle.inputEnabled = true;
			center.inputEnabled = true; //if center have no enabled input, clicking on it will enable


			let possiblePositions = [30, 60, 90, 120, 150, -180, -150, -120, -90, -60, -30];
			let getRandomAngle = function () {
				let randomPosition = Math.floor(Math.random() * possiblePositions.length);
				console.log(possiblePositions[randomPosition]);
				return possiblePositions[randomPosition];
			}

			outer.angle = getRandomAngle();
			middle.angle = getRandomAngle();


				let isFinished = function () {
					console.log('outer '+outer.angle);
					console.log('middle '+middle.angle);
					if (outer.angle === 0 && middle.angle === 0) {
						text = game.add.text(250, 16, '', { fill: '#ff87ff' });
						text.text = "You win";
					}
					return (outer.angle === 0 && middle.angle === 0);
				}

			let rotateCircle = function (circle) {
				if (isFinished() === true) {
					circle.angle = circle.angle;
				} else {
					circle.angle = Math.round(circle.angle+30); //because otherwise I'll get -119.99999 instead of -120
				}
			}

			outer.events.onInputDown.add(rotateCircle, this);
			middle.events.onInputDown.add(rotateCircle, this);
		}

	</script>
</body>

</html>
